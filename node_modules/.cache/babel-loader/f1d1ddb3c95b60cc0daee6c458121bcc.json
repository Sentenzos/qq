{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\my-own-social-network\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _toConsumableArray from\"D:\\\\my-own-social-network\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"D:\\\\my-own-social-network\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import{usersAPI}from\"../../API/API\";import updateObjValuesInArr from\"../../utils/updateObjValuesInArr\";import{searchIsEnded}from\"./reduxFormReducer\";import{setError}from\"./appReducer\";var SET_USERS=\"usersReducer/SET_USERS\";var SET_PAGE_NUMBER=\"usersReducer/SET_PAGE_NUMBER\";var IS_FETCHING=\"usersReducer/IS_FETCHING\";var SUBSCRIBE=\"usersReducer/SUBSCRIBE\";var UNSUBSCRIBE=\"usersReducer/UNSUBSCRIBE\";var TOGGLE_IS_SUBSCRIBING=\"usersReducer/TOGGLE_IS_SUBSCRIBING\";var PORTION_CONTROL=\"usersReducer/PORTION_CONTROL\";var USER_WAS_NOT_FOUND=\"usersReducer/USER_WAS_NOT_FOUND\";var RESET_PAGINATOR_PORTION=\"usersReducer/RESET_PAGINATOR_PORTION\";var SET_MODE=\"usersReducer/SET_MODE\";var initialState={users:[],totalUsersCount:null,usersOnPage:25,portionSize:20,isFetching:false,isSubscribing:[],paginatorPortion:1,pageNumber:1,//если true, то отрисуется элемент заглушка\nuserWasNotFound:false,//Режим отображения пользователей. Переменная находится в redux для ее использования другими компонентами\ndisplayMode:null// wantedUserName: null\n};export var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case IS_FETCHING:return _objectSpread({},state,{isFetching:action.isFetching});case SET_USERS:return _objectSpread({},state,{},action.usersData);case SUBSCRIBE:return _objectSpread({},state,{users:updateObjValuesInArr(state.users,\"id\",action.userId,[{\"followed\":true}])});case UNSUBSCRIBE:return _objectSpread({},state,{users:updateObjValuesInArr(state.users,\"id\",action.userId,[{\"followed\":false}])});case TOGGLE_IS_SUBSCRIBING:return _objectSpread({},state,{isSubscribing:action.toggle?[].concat(_toConsumableArray(state.isSubscribing),[action.userId]):state.isSubscribing.filter(function(id){return id!==action.userId;})});case PORTION_CONTROL:return _objectSpread({},state,{paginatorPortion:action.control?state.paginatorPortion+1:state.paginatorPortion-1});case RESET_PAGINATOR_PORTION:return _objectSpread({},state,{paginatorPortion:1});case SET_PAGE_NUMBER:return _objectSpread({},state,{pageNumber:action.pageNumber});case USER_WAS_NOT_FOUND:return _objectSpread({},state,{userWasNotFound:action.state});case SET_MODE:return _objectSpread({},state,{displayMode:action.mode});default:return state;}};export var setUsers=function setUsers(usersData){return{type:SET_USERS,usersData:usersData};};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:IS_FETCHING,isFetching:isFetching};};export var subscribe=function subscribe(userId){return{type:SUBSCRIBE,userId:userId};};export var unsubscribe=function unsubscribe(userId){return{type:UNSUBSCRIBE,userId:userId};};export var setPageNumber=function setPageNumber(pageNumber){return{type:SET_PAGE_NUMBER,pageNumber:pageNumber};};export var toggleIsSubscribing=function toggleIsSubscribing(userId,toggle){return{type:TOGGLE_IS_SUBSCRIBING,userId:userId,toggle:toggle};};export var portionControl=function portionControl(control){return{type:PORTION_CONTROL,control:control};};export var resetPaginatorPortion=function resetPaginatorPortion(){return{type:RESET_PAGINATOR_PORTION};};export var userWasNotFoundToggle=function userWasNotFoundToggle(state){return{type:USER_WAS_NOT_FOUND,state:state};};export var setMode=function setMode(mode){return{type:SET_MODE,mode:mode};};export var getUsers=function getUsers(pageData){return function _callee(dispatch){return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(getUsers_searchUser_united(pageData,pageData.pageNumber,usersAPI.getUsers,dispatch));case 2:dispatch(userWasNotFoundToggle(false));case 3:case\"end\":return _context.stop();}}});};};export var searchUser=function searchUser(data){return function _callee2(dispatch){var _ref,items;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regeneratorRuntime.awrap(getUsers_searchUser_united(data,data.pageNumber,usersAPI.searchUser,dispatch));case 2:_ref=_context2.sent;items=_ref.items;dispatch(searchIsEnded());if(items.length===0){dispatch(userWasNotFoundToggle(true));}case 6:case\"end\":return _context2.stop();}}});};};function getUsers_searchUser_united(data,pageNumber,apiMethod,dispatch){var response,_response$data,items,totalCount;return _regeneratorRuntime.async(function getUsers_searchUser_united$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(toggleIsFetching(true));_context3.prev=1;_context3.next=4;return _regeneratorRuntime.awrap(apiMethod(data));case 4:response=_context3.sent;//установка pageNumber в state для возвращения к последней странице при повторном переходе на /users\ndispatch(setPageNumber(pageNumber));if(!response.data.error){_context3.next=10;break;}dispatch(setError(true,\"Ошибка при получении пользователей.\"));_context3.next=13;break;case 10:_response$data=response.data,items=_response$data.items,totalCount=_response$data.totalCount;dispatch(setUsers({users:items,totalUsersCount:totalCount}));return _context3.abrupt(\"return\",response.data);case 13:_context3.next=19;break;case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](1);dispatch(setError(true,_context3.t0.message));throw _context3.t0;case 19:dispatch(toggleIsFetching(false));case 20:case\"end\":return _context3.stop();}}},null,null,[[1,15]]);}export var requestSubscribe=function requestSubscribe(userId){return function(dispatch){subscribe_unsubscribe_united(userId,usersAPI.subscribe,dispatch,subscribe);};};export var requestUnsubscribe=function requestUnsubscribe(userId){return function(dispatch){subscribe_unsubscribe_united(userId,usersAPI.unsubscribe,dispatch,unsubscribe);};};function subscribe_unsubscribe_united(userId,apiMethod,dispatch,actionCreator){var response;return _regeneratorRuntime.async(function subscribe_unsubscribe_united$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:dispatch(toggleIsSubscribing(userId,true));_context4.prev=1;_context4.next=4;return _regeneratorRuntime.awrap(apiMethod(userId));case 4:response=_context4.sent;if(response.data.resultCode===0){dispatch(actionCreator(userId));}else{dispatch(setError(true,\"При попытке подписки произошла ошибка.\"));}_context4.next=12;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](1);dispatch(setError(true,_context4.t0.message));throw _context4.t0;case 12:dispatch(toggleIsSubscribing(userId,false));case 13:case\"end\":return _context4.stop();}}},null,null,[[1,8]]);}","map":{"version":3,"sources":["D:/my-own-social-network/src/redux/reducers/usersReducer.js"],"names":["usersAPI","updateObjValuesInArr","searchIsEnded","setError","SET_USERS","SET_PAGE_NUMBER","IS_FETCHING","SUBSCRIBE","UNSUBSCRIBE","TOGGLE_IS_SUBSCRIBING","PORTION_CONTROL","USER_WAS_NOT_FOUND","RESET_PAGINATOR_PORTION","SET_MODE","initialState","users","totalUsersCount","usersOnPage","portionSize","isFetching","isSubscribing","paginatorPortion","pageNumber","userWasNotFound","displayMode","usersReducer","state","action","type","usersData","userId","toggle","filter","id","control","mode","setUsers","toggleIsFetching","subscribe","unsubscribe","setPageNumber","toggleIsSubscribing","portionControl","resetPaginatorPortion","userWasNotFoundToggle","setMode","getUsers","pageData","dispatch","getUsers_searchUser_united","searchUser","data","items","length","apiMethod","response","error","totalCount","message","requestSubscribe","subscribe_unsubscribe_united","requestUnsubscribe","actionCreator","resultCode"],"mappings":"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","sourcesContent":["import {usersAPI} from \"../../API/API\";\r\nimport updateObjValuesInArr from \"../../utils/updateObjValuesInArr\";\r\nimport {searchIsEnded} from \"./reduxFormReducer\";\r\nimport {setError} from \"./appReducer\";\r\n\r\nconst SET_USERS = \"usersReducer/SET_USERS\";\r\nconst SET_PAGE_NUMBER = \"usersReducer/SET_PAGE_NUMBER\";\r\nconst IS_FETCHING = \"usersReducer/IS_FETCHING\";\r\nconst SUBSCRIBE = \"usersReducer/SUBSCRIBE\";\r\nconst UNSUBSCRIBE = \"usersReducer/UNSUBSCRIBE\";\r\nconst TOGGLE_IS_SUBSCRIBING = \"usersReducer/TOGGLE_IS_SUBSCRIBING\";\r\nconst PORTION_CONTROL = \"usersReducer/PORTION_CONTROL\";\r\nconst USER_WAS_NOT_FOUND = \"usersReducer/USER_WAS_NOT_FOUND\";\r\nconst RESET_PAGINATOR_PORTION = \"usersReducer/RESET_PAGINATOR_PORTION\";\r\nconst SET_MODE = \"usersReducer/SET_MODE\";\r\n\r\n\r\nconst initialState = {\r\n  users: [],\r\n  totalUsersCount: null,\r\n  usersOnPage: 25,\r\n  portionSize: 20,\r\n  isFetching: false,\r\n  isSubscribing: [],\r\n  paginatorPortion: 1,\r\n  pageNumber: 1,\r\n  //если true, то отрисуется элемент заглушка\r\n  userWasNotFound: false,\r\n  //Режим отображения пользователей. Переменная находится в redux для ее использования другими компонентами\r\n  displayMode: null,\r\n  // wantedUserName: null\r\n};\r\n\r\nexport const usersReducer = (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case IS_FETCHING:\r\n      return {\r\n        ...state,\r\n        isFetching: action.isFetching\r\n      };\r\n    case SET_USERS:\r\n      return {\r\n        ...state,\r\n        ...action.usersData\r\n      };\r\n    case SUBSCRIBE:\r\n      return {\r\n        ...state,\r\n        users: updateObjValuesInArr(state.users, \"id\", action.userId,\r\n          [{\"followed\": true}])\r\n      };\r\n    case UNSUBSCRIBE:\r\n      return {\r\n        ...state,\r\n        users: updateObjValuesInArr(state.users, \"id\", action.userId,\r\n          [{\"followed\": false}])\r\n      };\r\n    case TOGGLE_IS_SUBSCRIBING:\r\n      return {\r\n        ...state,\r\n        isSubscribing: action.toggle ? [...state.isSubscribing, action.userId] :\r\n          state.isSubscribing.filter(id => id !== action.userId)\r\n      };\r\n    case PORTION_CONTROL:\r\n      return {\r\n        ...state,\r\n        paginatorPortion: action.control ? state.paginatorPortion + 1 : state.paginatorPortion - 1\r\n      };\r\n    case RESET_PAGINATOR_PORTION:\r\n      return {\r\n        ...state,\r\n        paginatorPortion: 1\r\n      };\r\n    case SET_PAGE_NUMBER:\r\n      return {\r\n        ...state,\r\n        pageNumber: action.pageNumber\r\n      };\r\n    case USER_WAS_NOT_FOUND:\r\n      return {\r\n        ...state,\r\n        userWasNotFound: action.state\r\n      };\r\n    case SET_MODE:\r\n      return {\r\n        ...state,\r\n        displayMode: action.mode\r\n      };\r\n    default:\r\n      return state\r\n  }\r\n};\r\n\r\n\r\nexport const setUsers = (usersData) => ({type: SET_USERS, usersData});\r\nexport const toggleIsFetching = (isFetching) => ({type: IS_FETCHING, isFetching});\r\nexport const subscribe = (userId) => ({type: SUBSCRIBE, userId});\r\nexport const unsubscribe = (userId) => ({type: UNSUBSCRIBE, userId});\r\nexport const setPageNumber = (pageNumber) => ({type: SET_PAGE_NUMBER, pageNumber});\r\nexport const toggleIsSubscribing = (userId, toggle) => ({type: TOGGLE_IS_SUBSCRIBING, userId, toggle});\r\nexport const portionControl = (control) => ({type: PORTION_CONTROL, control});\r\nexport const resetPaginatorPortion = () => ({type: RESET_PAGINATOR_PORTION});\r\nexport const userWasNotFoundToggle = (state) => ({type: USER_WAS_NOT_FOUND, state});\r\nexport const setMode = (mode) => ({type: SET_MODE, mode});\r\n\r\n\r\nexport const getUsers = (pageData) => async (dispatch) => {\r\n  await getUsers_searchUser_united(pageData, pageData.pageNumber, usersAPI.getUsers, dispatch);\r\n  dispatch(userWasNotFoundToggle(false));\r\n};\r\n\r\nexport const searchUser = (data) => async (dispatch) => {\r\n  const {items} = await getUsers_searchUser_united(data, data.pageNumber, usersAPI.searchUser, dispatch);\r\n  dispatch(searchIsEnded());\r\n  if (items.length === 0) {\r\n    dispatch(userWasNotFoundToggle(true));\r\n  }\r\n};\r\n\r\nasync function getUsers_searchUser_united (data, pageNumber, apiMethod, dispatch) {\r\n  dispatch(toggleIsFetching(true));\r\n  try {\r\n    const response = await apiMethod(data);\r\n    //установка pageNumber в state для возвращения к последней странице при повторном переходе на /users\r\n    dispatch(setPageNumber(pageNumber));\r\n    if (response.data.error) {\r\n      dispatch(setError(true, \"Ошибка при получении пользователей.\"));\r\n    } else {\r\n      const {items, totalCount} = response.data;\r\n      dispatch(setUsers({users: items, totalUsersCount: totalCount}));\r\n      return response.data;\r\n    }\r\n  } catch (e) {\r\n    dispatch(setError(true, e.message));\r\n    throw e\r\n  }\r\n  dispatch(toggleIsFetching(false));\r\n}\r\n\r\n\r\n\r\nexport const requestSubscribe = (userId) => (dispatch) => {\r\n  subscribe_unsubscribe_united(userId, usersAPI.subscribe, dispatch, subscribe);\r\n};\r\n\r\nexport const requestUnsubscribe = (userId) => (dispatch) => {\r\n  subscribe_unsubscribe_united(userId, usersAPI.unsubscribe, dispatch, unsubscribe);\r\n};\r\n\r\nasync function subscribe_unsubscribe_united(userId, apiMethod, dispatch, actionCreator) {\r\n  dispatch(toggleIsSubscribing(userId, true));\r\n  try {\r\n    const response = await apiMethod(userId);\r\n    if (response.data.resultCode === 0) {\r\n      dispatch(actionCreator(userId));\r\n    } else {\r\n      dispatch(setError(true, \"При попытке подписки произошла ошибка.\"));\r\n    }\r\n  } catch (e) {\r\n    dispatch(setError(true, e.message));\r\n    throw e\r\n  }\r\n  dispatch(toggleIsSubscribing(userId, false));\r\n}"]},"metadata":{},"sourceType":"module"}