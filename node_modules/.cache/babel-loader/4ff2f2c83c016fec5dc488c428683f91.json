{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\my-own-social-network\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _objectSpread from\"D:\\\\my-own-social-network\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import{getUserData,getUserStatus}from\"./profileReducer\";import{getMe}from\"./authReducer\";import{setMyAvatars}from\"./authReducer\";import{getDialogs}from\"./dialogsReducer\";import{profileAPI}from\"../../API/API\";var IS_INITIALIZED=\"authReducer/IS_INITIALIZED\";var SET_ERROR=\"authReducer/SET_ERROR\";var UNSET_ERROR=\"authReducer/UNSET_ERROR\";var initialState={isInitialized:null,appError:{state:false,message:null}};export var appReducer=function appReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case IS_INITIALIZED:return _objectSpread({},state,{isInitialized:action.state});case SET_ERROR:return _objectSpread({},state,{appError:{state:action.state,message:action.message}});case UNSET_ERROR:return _objectSpread({},state,{appError:_objectSpread({},state.appError,{state:false})});default:return state;}};export var isInitialized=function isInitialized(state){return{type:IS_INITIALIZED,state:state};};export var setError=function setError(state,message){return{type:SET_ERROR,state:state,message:message};};export var unsetError=function unsetError(){return{type:UNSET_ERROR};};export var initializator=function initializator(){return function _callee(dispatch,getState){var myId,res,myAvatars;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _regeneratorRuntime.awrap(dispatch(getMe()));case 3:myId=getState().auth.id;if(!myId){_context.next=15;break;}_context.next=7;return _regeneratorRuntime.awrap(profileAPI.getUserData(myId));case 7:res=_context.sent;myAvatars=res.data.photos;dispatch(setMyAvatars(myAvatars));_context.next=12;return _regeneratorRuntime.awrap(dispatch(getDialogs()));case 12:dispatch(isInitialized(true));_context.next=16;break;case 15:dispatch(isInitialized(false));case 16:_context.next=22;break;case 18:_context.prev=18;_context.t0=_context[\"catch\"](0);dispatch(setError(true,_context.t0.message));throw _context.t0;case 22:case\"end\":return _context.stop();}}},null,null,[[0,18]]);};};","map":{"version":3,"sources":["D:/my-own-social-network/src/redux/reducers/appReducer.js"],"names":["getUserData","getUserStatus","getMe","setMyAvatars","getDialogs","profileAPI","IS_INITIALIZED","SET_ERROR","UNSET_ERROR","initialState","isInitialized","appError","state","message","appReducer","action","type","setError","unsetError","initializator","dispatch","getState","myId","auth","id","res","myAvatars","data","photos"],"mappings":"gSAAA,OAAQA,WAAR,CAAqBC,aAArB,KAAyC,kBAAzC,CACA,OAAQC,KAAR,KAAoB,eAApB,CACA,OAAQC,YAAR,KAA2B,eAA3B,CACA,OAAQC,UAAR,KAAyB,kBAAzB,CACA,OAAQC,UAAR,KAAyB,eAAzB,CAIA,GAAMC,CAAAA,cAAc,CAAG,4BAAvB,CACA,GAAMC,CAAAA,SAAS,CAAG,uBAAlB,CACA,GAAMC,CAAAA,WAAW,CAAG,yBAApB,CAGA,GAAMC,CAAAA,YAAY,CAAG,CACnBC,aAAa,CAAE,IADI,CAEnBC,QAAQ,CAAE,CACRC,KAAK,CAAE,KADC,CAERC,OAAO,CAAE,IAFD,CAFS,CAArB,CASA,MAAO,IAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAkC,IAAjCF,CAAAA,KAAiC,2DAAzBH,YAAyB,IAAXM,CAAAA,MAAW,2CAC1D,OAAQA,MAAM,CAACC,IAAf,EACE,IAAKV,CAAAA,cAAL,CACE,wBACKM,KADL,EAEEF,aAAa,CAAEK,MAAM,CAACH,KAFxB,GAIF,IAAKL,CAAAA,SAAL,CACE,wBACKK,KADL,EAEED,QAAQ,CAAE,CACRC,KAAK,CAAEG,MAAM,CAACH,KADN,CAERC,OAAO,CAAEE,MAAM,CAACF,OAFR,CAFZ,GAOF,IAAKL,CAAAA,WAAL,CACE,wBACKI,KADL,EAEED,QAAQ,kBACHC,KAAK,CAACD,QADH,EAENC,KAAK,CAAE,KAFD,EAFV,GAOF,QACE,MAAOA,CAAAA,KAAP,CAvBJ,CAyBD,CA1BM,CA6BP,MAAO,IAAMF,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACE,KAAD,QAAY,CAACI,IAAI,CAAEV,cAAP,CAAuBM,KAAK,CAALA,KAAvB,CAAZ,EAAtB,CACP,MAAO,IAAMK,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACL,KAAD,CAAQC,OAAR,QAAqB,CAACG,IAAI,CAAET,SAAP,CAAkBK,KAAK,CAALA,KAAlB,CAAyBC,OAAO,CAAPA,OAAzB,CAArB,EAAjB,CACP,MAAO,IAAMK,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,SAAO,CAACF,IAAI,CAAER,WAAP,CAAP,EAAnB,CAGP,MAAO,IAAMW,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,SAAM,kBAAOC,QAAP,CAAiBC,QAAjB,2MAEzBD,QAAQ,CAAClB,KAAK,EAAN,CAFiB,SAGzBoB,IAHyB,CAGlBD,QAAQ,GAAGE,IAAX,CAAgBC,EAHE,KAI3BF,IAJ2B,2EAKXjB,UAAU,CAACL,WAAX,CAAuBsB,IAAvB,CALW,SAKvBG,GALuB,eAMvBC,SANuB,CAMXD,GAAG,CAACE,IAAJ,CAASC,MANE,CAO7BR,QAAQ,CAACjB,YAAY,CAACuB,SAAD,CAAb,CAAR,CAP6B,kDAQvBN,QAAQ,CAAChB,UAAU,EAAX,CARe,UAS7BgB,QAAQ,CAACV,aAAa,CAAC,IAAD,CAAd,CAAR,CAT6B,+BAW7BU,QAAQ,CAACV,aAAa,CAAC,KAAD,CAAd,CAAR,CAX6B,yFAc/BU,QAAQ,CAACH,QAAQ,CAAC,IAAD,CAAO,YAAEJ,OAAT,CAAT,CAAR,CAd+B,oFAAN,EAAtB","sourcesContent":["import {getUserData, getUserStatus} from \"./profileReducer\";\r\nimport {getMe} from \"./authReducer\";\r\nimport {setMyAvatars} from \"./authReducer\";\r\nimport {getDialogs} from \"./dialogsReducer\";\r\nimport {profileAPI} from \"../../API/API\";\r\n\r\n\r\n\r\nconst IS_INITIALIZED = \"authReducer/IS_INITIALIZED\";\r\nconst SET_ERROR = \"authReducer/SET_ERROR\";\r\nconst UNSET_ERROR = \"authReducer/UNSET_ERROR\";\r\n\r\n\r\nconst initialState = {\r\n  isInitialized: null,\r\n  appError: {\r\n    state: false,\r\n    message: null\r\n  }\r\n};\r\n\r\n\r\nexport const appReducer = (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case IS_INITIALIZED:\r\n      return {\r\n        ...state,\r\n        isInitialized: action.state\r\n      };\r\n    case SET_ERROR:\r\n      return {\r\n        ...state,\r\n        appError: {\r\n          state: action.state,\r\n          message: action.message\r\n        }\r\n      };\r\n    case UNSET_ERROR:\r\n      return {\r\n        ...state,\r\n        appError: {\r\n          ...state.appError,\r\n          state: false\r\n        }\r\n      };\r\n    default:\r\n      return state\r\n  }\r\n};\r\n\r\n\r\nexport const isInitialized = (state) => ({type: IS_INITIALIZED, state});\r\nexport const setError = (state, message) => ({type: SET_ERROR, state, message});\r\nexport const unsetError = () => ({type: UNSET_ERROR});\r\n\r\n\r\nexport const initializator = () => async (dispatch, getState) => {\r\n  try {\r\n    await dispatch(getMe());\r\n    const myId = getState().auth.id;\r\n    if (myId) {\r\n      const res = await profileAPI.getUserData(myId);\r\n      const myAvatars = res.data.photos;\r\n      dispatch(setMyAvatars(myAvatars));\r\n      await dispatch(getDialogs());\r\n      dispatch(isInitialized(true));\r\n    } else {\r\n      dispatch(isInitialized(false));\r\n    }\r\n  } catch (e) {\r\n    dispatch(setError(true, e.message));\r\n    throw e\r\n  }\r\n};\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}