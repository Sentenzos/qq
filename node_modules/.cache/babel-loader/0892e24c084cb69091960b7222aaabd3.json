{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\my-own-social-network\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _toConsumableArray from\"D:\\\\my-own-social-network\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"D:\\\\my-own-social-network\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import{profileAPI}from\"../../API/API\";import{stopSubmit}from\"redux-form\";import updateObjValuesInArr from\"../../utils/updateObjValuesInArr\";import demoAva1 from\"../../assets/img/demoAva1.jfif\";import demoAva2 from\"../../assets/img/demoAva2.jfif\";import demoAva3 from\"../../assets/img/demoAva3.png\";import{setError}from\"./appReducer\";var SET_USER_STATUS=\"profileReducer/SET_USER_STATUS\";var SET_USER_DATA=\"profileReducer/SET_USER_DATA\";var TOGGLE_PROFILE_IS_UPDATING=\"profileReducer/TOGGLE_PROFILE_IS_UPDATING\";var SET_USER_PHOTO=\"profileReducer/SET_USER_PHOTO_URL\";var ADD_NEW_MESSAGE=\"profileReducer/ADD_NEW_MESSAGE\";var SET_MY_LIKE=\"profileReducer/SET_MY_LIKE\";var LIKES_COUNT_CONTROL=\"profileReducer/LIKES_COUNT_CONTROL\";var STOP_ANIMATION=\"profileReducer/STOP_ANIMATION\";var DELETE_MESSAGE=\"profileReducer/DELETE_MESSAGE\";var initialState={status:\"\",userData:{userId:null,fullName:\"\",aboutMe:\"\",contacts:{},lookingForAJob:null,lookingForAJobDescription:\"\",photos:{}},profileIsUpdating:false,//захардкоденные сообщения, так как на сервере нет такого API\nwallMessages:[{id:3,name:\"Anna\",date:new Date(2019,1,30,16,15),likes:2,myLike:false,message:\"\\u041A\\u043E\\u0433\\u0434\\u0430-\\u043D\\u0438\\u0431\\u0443\\u0434\\u044C \\u0438 \\u044F \\u0431\\u0443\\u0434\\u0443 \\u0442\\u0430\\u043A \\u0438\\u0433\\u0440\\u0430\\u0442\\u044C <a href=\\\"https://www.youtube.com/watch?v=GwXeB5oVO2Y\\\">https://www.youtube.com/watch?v=GwXeB5oVO2Y</a>\",avatar:demoAva3},{id:2,name:\"Alex\",date:new Date(2019,1,19,12,30),likes:5,myLike:true,message:\"Идейные соображения высшего порядка, а также рамки и место обучения кадров позволяет оценить значение новых предложений. \"+\"Разнообразный и богатый опыт рамки и место обучения кадров представляет собой интересный эксперимент проверки соответствующий условий активизации.\",avatar:demoAva1},{id:1,name:\"Denis\",date:new Date(2019,10,19,11,40),likes:2,myLike:false,message:\"Задача организации, в особенности же консультация с широким активом требуют определения и уточнения систем массового участия. \"+\"Повседневная практика показывает, что постоянный количественный рост и сфера нашей активности представляет собой интересный эксперимент проверки модели развития. \"+\"Значимость этих проблем настолько очевидна, что постоянный количественный рост и сфера нашей активности позволяет оценить значение форм развития. \"+\"Значимость этих проблем настолько очевидна, что постоянный количественный рост и сфера нашей активности требуют определения и уточнения модели развития.\",avatar:demoAva2}]};export var profileReducer=function profileReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_USER_STATUS:return _objectSpread({},state,{status:action.userStatus});case SET_USER_DATA:return _objectSpread({},state,{userData:_objectSpread({},action.userData)});case TOGGLE_PROFILE_IS_UPDATING:return _objectSpread({},state,{profileIsUpdating:action.status});case SET_USER_PHOTO:return _objectSpread({},state,{userData:_objectSpread({},state.userData,{photos:action.photos})});case ADD_NEW_MESSAGE:return _objectSpread({},state,{wallMessages:[{id:Math.random(),name:action.userName,date:new Date(),likes:0,myLike:false,message:action.message,avatar:action.avatar,animationState:true}].concat(_toConsumableArray(state.wallMessages))});case SET_MY_LIKE:return _objectSpread({},state,{wallMessages:updateObjValuesInArr(state.wallMessages,\"id\",action.id,[{\"myLike\":action.state},{\"likes\":action.likes}])});case STOP_ANIMATION:return _objectSpread({},state,{wallMessages:updateObjValuesInArr(state.wallMessages,\"id\",action.id,[{\"animationState\":false}])});case DELETE_MESSAGE:return _objectSpread({},state,{wallMessages:state.wallMessages.filter(function(m){return m.id!==action.messageId;})});default:return state;}};export var setUserStatus=function setUserStatus(userStatus){return{type:SET_USER_STATUS,userStatus:userStatus};};export var setUserData=function setUserData(userData){return{type:SET_USER_DATA,userData:userData};};export var toggleProfileIsUpdating=function toggleProfileIsUpdating(status){return{type:TOGGLE_PROFILE_IS_UPDATING,status:status};};export var setUserPhoto=function setUserPhoto(photos){return{type:SET_USER_PHOTO,photos:photos};};export var addNewMessage=function addNewMessage(message,userName,avatar){return{type:ADD_NEW_MESSAGE,message:message,userName:userName,avatar:avatar};};export var setMyLike=function setMyLike(state,id,likes){return{type:SET_MY_LIKE,state:state,id:id,likes:likes};};export var stopAnimation=function stopAnimation(id){return{type:STOP_ANIMATION,id:id};};export var setMessagesAfterDelete=function setMessagesAfterDelete(messageId){return{type:DELETE_MESSAGE,messageId:messageId};};export var getUserStatus=function getUserStatus(userId){return function _callee(dispatch){var userStatus;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(profileAPI.getStatus(userId));case 2:userStatus=_context.sent;dispatch(setUserStatus(userStatus.data));case 4:case\"end\":return _context.stop();}}});};};export var sendNewUserStatus=function sendNewUserStatus(status){return function _callee2(dispatch){var response;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return _regeneratorRuntime.awrap(profileAPI.sendNewStatus(status));case 3:response=_context2.sent;if(response.data.resultCode===0){dispatch(setUserStatus(status));}else{dispatch(setError(true,\"Не удалось обновить статус.\"));}_context2.next=11;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);dispatch(setError(true,_context2.t0.message));throw _context2.t0;case 11:case\"end\":return _context2.stop();}}},null,null,[[0,7]]);};};export var getUserData=function getUserData(userId){return function _callee3(dispatch){var response;return _regeneratorRuntime.async(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return _regeneratorRuntime.awrap(profileAPI.getUserData(userId));case 3:response=_context3.sent;dispatch(setUserData(response.data));_context3.next=11;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);dispatch(setError(true,_context3.t0.message));throw _context3.t0;case 11:case\"end\":return _context3.stop();}}},null,null,[[0,7]]);};};export var updateUserData=function updateUserData(userData){return function _callee4(dispatch,getState){var response,userId,message,action;return _regeneratorRuntime.async(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:dispatch(toggleProfileIsUpdating(true));_context4.prev=1;_context4.next=4;return _regeneratorRuntime.awrap(profileAPI.saveUserData(userData));case 4:response=_context4.sent;if(!(response.data.resultCode===0)){_context4.next=12;break;}userId=getState().profilePage.userData.userId;_context4.next=9;return _regeneratorRuntime.awrap(dispatch(getUserData(userId)));case 9:dispatch(toggleProfileIsUpdating(false));_context4.next=15;break;case 12:message=response.data.messages.length>0?response.data.messages[0]:\"Some error\";action=stopSubmit(\"profileData\",{_error:message});dispatch(action);case 15:_context4.next=22;break;case 17:_context4.prev=17;_context4.t0=_context4[\"catch\"](1);dispatch(setError(true,_context4.t0.message));dispatch(toggleProfileIsUpdating(false));throw _context4.t0;case 22:case\"end\":return _context4.stop();}}},null,null,[[1,17]]);};};export var updateUserPhoto=function updateUserPhoto(photo){return function _callee5(dispatch){var response;return _regeneratorRuntime.async(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return _regeneratorRuntime.awrap(profileAPI.updatePhoto(photo));case 3:response=_context5.sent;if(response.data.resultCode===0){dispatch(setUserPhoto(response.data.data.photos));}else{dispatch(setError(true,\"Не удалось обновить фото.\"));}_context5.next=11;break;case 7:_context5.prev=7;_context5.t0=_context5[\"catch\"](0);dispatch(setError(true,_context5.t0.message));throw _context5.t0;case 11:case\"end\":return _context5.stop();}}},null,null,[[0,7]]);};};export var sendNewMessage=function sendNewMessage(message){return function(dispatch,getState){//тут асинхронный запрос на сервер и подтверждение того, что он завершился успешно\nvar userName=getState().profilePage.userData.fullName;var avatar=getState().auth.myAvatars.small;dispatch(addNewMessage(message,userName,avatar));};};export var likesControl=function likesControl(id){return function(dispatch,getState){//тут тоже должен быть запрос на сервер, но увы\nvar message=getState().profilePage.wallMessages.find(function(message){return message.id===id;});if(message.myLike){dispatch(setMyLike(false,id,message.likes-1));}else{dispatch(setMyLike(true,id,message.likes+1));}};};export var deleteMessage=function deleteMessage(messageId){return function(dispatch,getState){//тут асинхронный запрос на сервер и подтверждение того, что он завершился успешно\ndispatch(setMessagesAfterDelete(messageId));};};","map":{"version":3,"sources":["D:/my-own-social-network/src/redux/reducers/profileReducer.js"],"names":["profileAPI","stopSubmit","updateObjValuesInArr","demoAva1","demoAva2","demoAva3","setError","SET_USER_STATUS","SET_USER_DATA","TOGGLE_PROFILE_IS_UPDATING","SET_USER_PHOTO","ADD_NEW_MESSAGE","SET_MY_LIKE","LIKES_COUNT_CONTROL","STOP_ANIMATION","DELETE_MESSAGE","initialState","status","userData","userId","fullName","aboutMe","contacts","lookingForAJob","lookingForAJobDescription","photos","profileIsUpdating","wallMessages","id","name","date","Date","likes","myLike","message","avatar","profileReducer","state","action","type","userStatus","Math","random","userName","animationState","filter","m","messageId","setUserStatus","setUserData","toggleProfileIsUpdating","setUserPhoto","addNewMessage","setMyLike","stopAnimation","setMessagesAfterDelete","getUserStatus","dispatch","getStatus","data","sendNewUserStatus","sendNewStatus","response","resultCode","getUserData","updateUserData","getState","saveUserData","profilePage","messages","length","_error","updateUserPhoto","photo","updatePhoto","sendNewMessage","auth","myAvatars","small","likesControl","find","deleteMessage"],"mappings":"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","sourcesContent":["import {profileAPI} from \"../../API/API\";\r\nimport {stopSubmit} from \"redux-form\";\r\nimport updateObjValuesInArr from \"../../utils/updateObjValuesInArr\"\r\nimport demoAva1 from \"../../assets/img/demoAva1.jfif\";\r\nimport demoAva2 from \"../../assets/img/demoAva2.jfif\";\r\nimport demoAva3 from \"../../assets/img/demoAva3.png\";\r\nimport {setError} from \"./appReducer\";\r\n\r\n\r\nconst SET_USER_STATUS = \"profileReducer/SET_USER_STATUS\";\r\nconst SET_USER_DATA = \"profileReducer/SET_USER_DATA\";\r\nconst TOGGLE_PROFILE_IS_UPDATING = \"profileReducer/TOGGLE_PROFILE_IS_UPDATING\";\r\nconst SET_USER_PHOTO = \"profileReducer/SET_USER_PHOTO_URL\";\r\nconst ADD_NEW_MESSAGE = \"profileReducer/ADD_NEW_MESSAGE\";\r\nconst SET_MY_LIKE = \"profileReducer/SET_MY_LIKE\";\r\nconst LIKES_COUNT_CONTROL = \"profileReducer/LIKES_COUNT_CONTROL\";\r\nconst STOP_ANIMATION = \"profileReducer/STOP_ANIMATION\";\r\nconst DELETE_MESSAGE = \"profileReducer/DELETE_MESSAGE\";\r\n\r\n\r\nconst initialState = {\r\n  status: \"\",\r\n  userData: {\r\n    userId: null,\r\n    fullName: \"\",\r\n    aboutMe: \"\",\r\n    contacts: {},\r\n    lookingForAJob: null,\r\n    lookingForAJobDescription: \"\",\r\n    photos: {},\r\n  },\r\n  profileIsUpdating: false,\r\n  //захардкоденные сообщения, так как на сервере нет такого API\r\n\r\n  wallMessages: [\r\n    {\r\n      id: 3,\r\n      name: \"Anna\",\r\n      date: new Date(2019, 1, 30, 16, 15),\r\n      likes: 2,\r\n      myLike: false,\r\n      message: `Когда-нибудь и я буду так играть <a href=\"https://www.youtube.com/watch?v=GwXeB5oVO2Y\">https://www.youtube.com/watch?v=GwXeB5oVO2Y</a>`,\r\n      avatar: demoAva3\r\n    },\r\n    {\r\n      id: 2,\r\n      name: \"Alex\",\r\n      date: new Date(2019, 1, 19, 12, 30),\r\n      likes: 5,\r\n      myLike: true,\r\n      message: \"Идейные соображения высшего порядка, а также рамки и место обучения кадров позволяет оценить значение новых предложений. \" +\r\n        \"Разнообразный и богатый опыт рамки и место обучения кадров представляет собой интересный эксперимент проверки соответствующий условий активизации.\",\r\n      avatar: demoAva1\r\n    },\r\n    {\r\n      id: 1,\r\n      name: \"Denis\",\r\n      date: new Date(2019, 10, 19, 11, 40),\r\n      likes: 2,\r\n      myLike: false,\r\n      message: \"Задача организации, в особенности же консультация с широким активом требуют определения и уточнения систем массового участия. \" +\r\n        \"Повседневная практика показывает, что постоянный количественный рост и сфера нашей активности представляет собой интересный эксперимент проверки модели развития. \" +\r\n        \"Значимость этих проблем настолько очевидна, что постоянный количественный рост и сфера нашей активности позволяет оценить значение форм развития. \" +\r\n        \"Значимость этих проблем настолько очевидна, что постоянный количественный рост и сфера нашей активности требуют определения и уточнения модели развития.\",\r\n      avatar: demoAva2\r\n    }\r\n  ]\r\n};\r\n\r\nexport const profileReducer = (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case SET_USER_STATUS:\r\n      return {\r\n        ...state,\r\n        status: action.userStatus\r\n      };\r\n    case SET_USER_DATA:\r\n      return {\r\n        ...state,\r\n        userData: {...action.userData}\r\n      };\r\n    case TOGGLE_PROFILE_IS_UPDATING:\r\n      return {\r\n        ...state,\r\n        profileIsUpdating: action.status\r\n      };\r\n    case SET_USER_PHOTO:\r\n      return {\r\n        ...state,\r\n        userData: {\r\n          ...state.userData,\r\n          photos: action.photos\r\n        }\r\n      };\r\n    case ADD_NEW_MESSAGE:\r\n      return {\r\n        ...state,\r\n        wallMessages: [{\r\n          id: Math.random(),\r\n          name: action.userName,\r\n          date: new Date(),\r\n          likes: 0,\r\n          myLike: false,\r\n          message: action.message,\r\n          avatar: action.avatar,\r\n          animationState: true\r\n        }, ...state.wallMessages]\r\n      };\r\n    case SET_MY_LIKE:\r\n      return {\r\n        ...state,\r\n        wallMessages: updateObjValuesInArr(state.wallMessages, \"id\", action.id, [{\"myLike\": action.state}, {\"likes\": action.likes}])\r\n      };\r\n    case STOP_ANIMATION:\r\n      return {\r\n        ...state,\r\n        wallMessages: updateObjValuesInArr(state.wallMessages, \"id\", action.id, [{\"animationState\": false}])\r\n      };\r\n    case DELETE_MESSAGE:\r\n      return {\r\n        ...state,\r\n        wallMessages: state.wallMessages.filter(m => {\r\n          return m.id !== action.messageId\r\n        })\r\n      };\r\n    default:\r\n      return state\r\n  }\r\n};\r\n\r\nexport const setUserStatus = (userStatus) => ({type: SET_USER_STATUS, userStatus});\r\nexport const setUserData = (userData) => ({type: SET_USER_DATA, userData});\r\nexport const toggleProfileIsUpdating = (status) => ({type: TOGGLE_PROFILE_IS_UPDATING, status});\r\nexport const setUserPhoto = (photos) => ({type: SET_USER_PHOTO, photos});\r\nexport const addNewMessage = (message, userName, avatar) => ({type: ADD_NEW_MESSAGE, message, userName, avatar});\r\nexport const setMyLike = (state, id, likes) => ({type: SET_MY_LIKE, state, id, likes});\r\nexport const stopAnimation = (id) => ({type: STOP_ANIMATION, id});\r\nexport const setMessagesAfterDelete = (messageId) => ({type: DELETE_MESSAGE, messageId});\r\n\r\n\r\nexport const getUserStatus = (userId) => async (dispatch) => {\r\n  const userStatus = await profileAPI.getStatus(userId);\r\n  dispatch(setUserStatus(userStatus.data));\r\n};\r\n\r\nexport const sendNewUserStatus = (status) => async (dispatch) => {\r\n  try {\r\n    const response = await profileAPI.sendNewStatus(status);\r\n    if (response.data.resultCode === 0) {\r\n      dispatch(setUserStatus(status));\r\n    } else {\r\n      dispatch(setError(true, \"Не удалось обновить статус.\"));\r\n    }\r\n  } catch (e) {\r\n    dispatch(setError(true, e.message));\r\n    throw e\r\n  }\r\n};\r\n\r\nexport const getUserData = (userId) => async (dispatch) => {\r\n  try {\r\n    const response = await profileAPI.getUserData(userId);\r\n    dispatch(setUserData(response.data));\r\n  } catch (e) {\r\n    dispatch(setError(true, e.message));\r\n    throw e\r\n  }\r\n};\r\n\r\nexport const updateUserData = (userData) => async (dispatch, getState) => {\r\n  dispatch(toggleProfileIsUpdating(true));\r\n  try {\r\n    const response = await profileAPI.saveUserData(userData);\r\n    if (response.data.resultCode === 0) {\r\n      const userId = getState().profilePage.userData.userId;\r\n      await dispatch(getUserData(userId));\r\n      dispatch(toggleProfileIsUpdating(false));\r\n    } else {\r\n      const message = response.data.messages.length > 0 ?\r\n        response.data.messages[0] : \"Some error\";\r\n      const action = stopSubmit(\"profileData\", {_error: message});\r\n      dispatch(action);\r\n    }\r\n  } catch (e) {\r\n    dispatch(setError(true, e.message));\r\n    dispatch(toggleProfileIsUpdating(false));\r\n    throw e\r\n  }\r\n};\r\n\r\nexport const updateUserPhoto = (photo) => async (dispatch) => {\r\n  try {\r\n    const response = await profileAPI.updatePhoto(photo);\r\n    if (response.data.resultCode === 0) {\r\n      dispatch(setUserPhoto(response.data.data.photos));\r\n    } else {\r\n      dispatch(setError(true, \"Не удалось обновить фото.\"));\r\n    }\r\n  } catch (e) {\r\n    dispatch(setError(true, e.message));\r\n    throw e\r\n  }\r\n};\r\n\r\nexport const sendNewMessage = (message) => (dispatch, getState) => {\r\n  //тут асинхронный запрос на сервер и подтверждение того, что он завершился успешно\r\n  const userName = getState().profilePage.userData.fullName;\r\n  const avatar = getState().auth.myAvatars.small;\r\n  dispatch(addNewMessage(message, userName, avatar));\r\n};\r\n\r\nexport const likesControl = (id) => (dispatch, getState) => {\r\n  //тут тоже должен быть запрос на сервер, но увы\r\n  const message = getState().profilePage.wallMessages.find((message) => {\r\n    return message.id === id\r\n  });\r\n\r\n  if (message.myLike) {\r\n    dispatch(setMyLike(false, id, message.likes - 1));\r\n  } else {\r\n    dispatch(setMyLike(true, id, message.likes + 1));\r\n  }\r\n};\r\n\r\nexport const deleteMessage = (messageId) => (dispatch, getState) => {\r\n  //тут асинхронный запрос на сервер и подтверждение того, что он завершился успешно\r\n  dispatch(setMessagesAfterDelete(messageId));\r\n};"]},"metadata":{},"sourceType":"module"}